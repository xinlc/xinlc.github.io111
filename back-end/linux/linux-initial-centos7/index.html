<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <link rel="mask-icon" href="/favicon.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.lichao.xin","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"appID":"3ZZ8ITB7HE","apiKey":"062eb5a54afbcbf3f20452d58fc40035","indexName":"xinlc","hits":{"per_page":10},"labels":{"input_placeholder":"搜索","hits_empty":"未发现与「${query}」相关的内容","hits_stats":"${hits} 条相关条目，使用了 ${time} 毫秒"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="CentOS7 安装参考在 VMware ESXi 中安装 CentOS7 安装完 CentOS7（Minimal Install）操作系统后，需要对其进行初始化的配置，以增强服务器的安全性和可用性，本文记录 CentOS7 系统安装后需要做的初始化配置。">
<meta property="og:type" content="article">
<meta property="og:title" content="CentOS 7 安装后的相关配置">
<meta property="og:url" content="https://blog.lichao.xin/back-end/linux/linux-initial-centos7/index.html">
<meta property="og:site_name" content="Richard Xin&#39;s Blog">
<meta property="og:description" content="CentOS7 安装参考在 VMware ESXi 中安装 CentOS7 安装完 CentOS7（Minimal Install）操作系统后，需要对其进行初始化的配置，以增强服务器的安全性和可用性，本文记录 CentOS7 系统安装后需要做的初始化配置。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-09-12T19:00:00.000Z">
<meta property="article:modified_time" content="2021-06-14T01:33:22.395Z">
<meta property="article:author" content="Richard">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="centos7">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://blog.lichao.xin/back-end/linux/linux-initial-centos7/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>CentOS 7 安装后的相关配置 | Richard Xin's Blog</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?4530ac9d0bc4e258535c4a9b17029f0c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Richard Xin's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Richard Xin's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Quick notes</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">132</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">59</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">12</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

      
    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.lichao.xin/back-end/linux/linux-initial-centos7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/18113256?v=3&s=460">
      <meta itemprop="name" content="Richard">
      <meta itemprop="description" content="惶者生存，偏执者成功">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Richard Xin's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          CentOS 7 安装后的相关配置
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-12 19:00:00" itemprop="dateCreated datePublished" datetime="2019-09-12T19:00:00+00:00">2019-09-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-14 01:33:22" itemprop="dateModified" datetime="2021-06-14T01:33:22+00:00">2021-06-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><code>CentOS7</code> 安装参考<a href="/back-end/linux/vmware-esxi-centos7/#more">在 VMware ESXi 中安装 CentOS7</a></p>
<p>安装完 <code>CentOS7（Minimal Install）</code>操作系统后，需要对其进行初始化的配置，以增强服务器的安全性和可用性，本文记录 <code>CentOS7</code> 系统安装后需要做的初始化配置。</p>
<a id="more"></a>

<h2 id="配置网络"><a href="#配置网络" class="headerlink" title="配置网络"></a>配置网络</h2><p><code>CentOS7</code> 安装后一般没有网卡配置，需要自行添加网卡配置（在上一篇文章已经添加了<code>ens192</code> 网卡，如果网络好用省略此步骤）。</p>
<h3 id="修改网卡配置文件"><a href="#修改网卡配置文件" class="headerlink" title="修改网卡配置文件"></a>修改网卡配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看IP地址，MAC地址（ether）</span></span><br><span class="line">ip addr</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 nmcli con show 命令，查看网卡的UUID信息</span></span><br><span class="line">nmcli con show</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入网络配置文件夹</span></span><br><span class="line"><span class="built_in">cd</span> /etc/sysconfig/network-scripts</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制 ifcfg-ens192 网卡信息</span></span><br><span class="line">cp ifcfg-ens192 ifcfg-eth0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改 enth0 网卡信息</span></span><br><span class="line">vi ifcfg-eth0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启网络服务</span></span><br><span class="line">service network restart</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试网络</span></span><br><span class="line">ping -c 4 www.baidu.com</span><br></pre></td></tr></table></figure>

<p>网卡参数说：</p>
<ul>
<li>TYPE=Ethernet（设备连接类型，此处为以太网）；</li>
<li>IPADDR=IP 地址（192.168.2.201）；</li>
<li>NETMASK=子掩码（255.255.255.0）；</li>
<li>GATEWAY=网关（192.168.2.1）；</li>
<li>DNS1=DNS 地址 （114.114.114.114 或 8.8.8.8）；</li>
<li>ONBOOT=yes（网卡随系统启动， 默认为 no）；</li>
<li>BOOTPROTO=static (使用动态 IP 还是静态 IP，默认为 dhcp）；</li>
<li>HWADDR=MAC 地址；</li>
</ul>
<h2 id="安装常用工具"><a href="#安装常用工具" class="headerlink" title="安装常用工具"></a>安装常用工具</h2><p>由于是最小化安装系统，很多常用工具没有安装，调通网络后就可使用 yum 安装了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装常用网络工具，如：ifconfig、netstat等</span></span><br><span class="line">yum install net-tools</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 vim</span></span><br><span class="line">yum -y install vim</span><br></pre></td></tr></table></figure>

<h2 id="创建一个新用户"><a href="#创建一个新用户" class="headerlink" title="创建一个新用户"></a>创建一个新用户</h2><p>为了系统安全，一般我们只会用普通用户进行操作，新安装系统后添加一个普通用户。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加普通用户</span></span><br><span class="line">adduser leo</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置密码</span></span><br><span class="line">passwd 123456</span><br></pre></td></tr></table></figure>

<blockquote>
<p>p.s. 添加新用户或更改 root 密码，不要关闭当前窗口，新打开一个窗口进行登录测试是否好用，如果失败还可以在当前窗口继续操作，（都是泪啊……）</p>
</blockquote>
<h2 id="给普通用户-root-权限"><a href="#给普通用户-root-权限" class="headerlink" title="给普通用户 root 权限"></a>给普通用户 root 权限</h2><p>我们用普通用户，进行普通的操作，但是有时我们需要更大的权限进行操作，我们一般不会使用 <code>root</code> 登进登录，一般使用 <code>sudo</code> （Super User do）命令</p>
<p>为了将 <code>sudo</code> 权限给普通用户，我们需要将新用户加入 <code>wheel</code> 组中，<code>CentOS</code> 默认的 <code>wheel</code> 组有运行 <code>sudo</code> 的权限。<br>我们使用 <code>root</code> 用户，将 <code>leo</code> 用户加入到 <code>wheel</code> 组中。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpasswd -a leo wheel</span><br></pre></td></tr></table></figure>

<p>或者修改 sudoers 文件提升用户权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 说明：格式为（用户名    网络中的主机=（执行命令的目标用户）    执行的命令范围）</span></span><br><span class="line"></span><br><span class="line">vim /etc/sudoers</span><br><span class="line"></span><br><span class="line">leo    ALL=(ALL)       ALL</span><br></pre></td></tr></table></figure>

<h2 id="只允许-wheel-用户组的用户-su-切换"><a href="#只允许-wheel-用户组的用户-su-切换" class="headerlink" title="只允许 wheel 用户组的用户 su 切换"></a>只允许 wheel 用户组的用户 su 切换</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/pam.d/su</span><br><span class="line"><span class="comment"># Uncomment the following line to require a user to be in the "wheel" group.</span></span><br><span class="line">auth            required        pam_wheel.so use_uid</span><br></pre></td></tr></table></figure>

<blockquote>
<p>其他用户切换 root，即使输对密码也会提示 su: incorrect password</p>
</blockquote>
<h2 id="tty-登录超时设置"><a href="#tty-登录超时设置" class="headerlink" title="tty 登录超时设置"></a>tty 登录超时设置</h2><p>用户在线 5 分钟无操作则超时断开连接，在<code>/etc/profile</code>中添加：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> TMOUT=300</span><br><span class="line"><span class="built_in">readonly</span> TMOUT</span><br></pre></td></tr></table></figure>

<h2 id="限制登录失败次数并锁定"><a href="#限制登录失败次数并锁定" class="headerlink" title="限制登录失败次数并锁定"></a>限制登录失败次数并锁定</h2><p>登录失败 5 次锁定 180 秒，根据需要设置是否包括 root</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/pam.d/login</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在最后添加一行</span></span><br><span class="line">auth required pam_tally2.so deny=6 unlock_time=180 even_deny_root root_unlock_time=180</span><br></pre></td></tr></table></figure>

<h2 id="禁止-root-使用-ssh-登录"><a href="#禁止-root-使用-ssh-登录" class="headerlink" title="禁止 root 使用 ssh 登录"></a>禁止 root 使用 ssh 登录</h2><p>CentOS7 默认允许任何账户通过 <code>ssh</code> 登录，为了系统安全应该禁用 <code>root</code> 账户使用 <code>ssh</code> 登录，如果想要使用 <code>root</code> 权限只需只需 <code>su</code> 或 <code>sudo</code> 获取<code>root</code> 权限即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br><span class="line"></span><br><span class="line"><span class="comment"># PermitRootLogin yes 修改为：</span></span><br><span class="line">PermitRootLogin no</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存后重启 sshd 服务</span></span><br><span class="line">systemctl restart sshd.service</span><br></pre></td></tr></table></figure>

<blockquote>
<p>想要获取 root 权限，就要必须破解 root 和普通用户密码，提升了系统安全性。</p>
</blockquote>
<h2 id="登录-IP-限制"><a href="#登录-IP-限制" class="headerlink" title="登录 IP 限制"></a>登录 IP 限制</h2><p>允许 ssh 的用户和来源 ip</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只允许 leo 用户 使用 116.3.197.* ip段登录</span></span><br><span class="line">AllowUsers leo@116.3.197.*</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存后重启 sshd 服务</span></span><br><span class="line">systemctl restart sshd.service</span><br></pre></td></tr></table></figure>

<h2 id="启用公钥授权验证登入-ssh"><a href="#启用公钥授权验证登入-ssh" class="headerlink" title="启用公钥授权验证登入 ssh"></a>启用公钥授权验证登入 ssh</h2><p>如果客户端想访问服务端，可以使用 ssh 命令，SSH 支持用户名和密码方式，也支持公钥授权。使用密钥文件代替普通的简单密码认证也会极大的提高安全性。</p>
<p>在客户端生成公钥和私钥（由于我是 MacOS 有 <code>ssh-keygen</code> 工具，如果没有也可以在 <code>CentOS</code> 生成秘钥，然后把私钥下载到客户端）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 执行命令之后，会在 $HOME 下的 .ssh 目录下生成 2 个文件，id_rsa 为私钥，id_rsa.pub 为公钥</span></span><br><span class="line">ssh-keygen -t rsa -b 2048</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generating public/private rsa key pair.</span></span><br><span class="line"><span class="comment"># Enter file in which to save the key (/root/.ssh/id_rsa):</span></span><br><span class="line"><span class="comment"># Enter passphrase (empty for no passphrase):</span></span><br><span class="line"><span class="comment"># Enter same passphrase again:</span></span><br><span class="line"><span class="comment"># Your identification has been saved in /root/.ssh/id_rsa.</span></span><br><span class="line"><span class="comment"># Your public key has been saved in /root/.ssh/id_rsa.pub.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成 SSH 密钥对之后，需要将本地（客户端）的公钥，拷贝到服务器（服务端），有如下 2 中方法</span></span><br><span class="line"><span class="comment"># 1. 使用 ssh-copy-id</span></span><br><span class="line"><span class="comment"># 这会将本地用户的公钥拷贝到服务端的 leo 用户的 .ssh/authorized_keys 文件中</span></span><br><span class="line">ssh-copy-id leo@SERVER_IP_ADDRESS</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 如果不支持 ssh-copy-id 命令，需要手动将公钥 ~/.ssh/id_ras.pub 的内容拷贝到服务端用户 leo 的 ~/.ssh/authorized_keys 文件中。</span></span><br><span class="line">cat ~/.ssh/id_rsa.pub | ssh leo@SERVER_IP_ADDRESS <span class="string">"mkdir -p ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意 authorized_keys 文件需要 600 或 400 权限，否则 sshd 不会读取</span></span><br><span class="line">chmod 600 ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>

<p>在服务器生成秘钥命令也是一样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成公私钥</span></span><br><span class="line">ssh-keygen -t rsa -b 2048</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将公钥添加到 authorized_keys 文件，一行一条公钥</span></span><br><span class="line"><span class="comment"># 可以使用scp 将私钥下载到客户端</span></span><br><span class="line">scp -P 22 leo@SERVER_IP_ADDRESS:~/.ssh/id_rsa ~/.ssh/</span><br></pre></td></tr></table></figure>

<p>使用秘钥登录：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -i ~/.ssh/201_id_rsa root@192.168.2.201 -p 22</span><br></pre></td></tr></table></figure>

<p>多个<code>SSH</code>秘钥配置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成多个秘钥</span></span><br><span class="line">ssh-keygen -t rsa -b 4096 -C xinlichao2016@gamil.com -f .ssh/201_id_rsa</span><br><span class="line">ssh-keygen -t rsa -b 4096 -C xinlichao2016@gamil.com -f .ssh/202_id_rsa</span><br><span class="line"></span><br><span class="line"><span class="comment"># 上传</span></span><br><span class="line">ssh-copy-id -i .ssh/201_id_rsa.pub root@192.168.2.201</span><br><span class="line">ssh-copy-id -i .ssh/202_id_rsa.pub root@192.168.2.202</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一种 添加 ssh-key 到 ssh-agent, 添加代理，这是为了让请求自动对应相应的账号，git ssh 多账号也可用该方法</span></span><br><span class="line">ssh-add ~/.ssh/201_id_rsa</span><br><span class="line">ssh-add ~/.ssh/202_id_rsa</span><br><span class="line"></span><br><span class="line"><span class="comment"># 其他命令</span></span><br><span class="line">ssh-add -l <span class="comment"># 查看</span></span><br><span class="line">ssh-add -A <span class="comment"># 默认添加：id_rsa</span></span><br><span class="line">ssh-add -K ~/.ssh/201_id_rsa  <span class="comment"># 指定添加</span></span><br><span class="line">ssh-add -D  <span class="comment"># 全部删除</span></span><br><span class="line">ssh-add -d  ~/.ssh/201_id_rsa  <span class="comment"># 指定删除</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># p.s. ssh-agent 这种方式每次开机都需要添加一次，可以写进 .bashrc 或 .bash_profile</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二种方式配置 ssh config</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 config 并 添加以下内容</span></span><br><span class="line">vim ~/.ssh/config</span><br><span class="line"></span><br><span class="line">Host 192.168.2.201</span><br><span class="line">  IdentityFile ~/.ssh/201_id_rsa</span><br><span class="line">Host 192.168.2.202</span><br><span class="line">  IdentityFile ~/.ssh/202_id_rsa</span><br><span class="line"></span><br><span class="line"><span class="comment"># 别名方式配置</span></span><br><span class="line">Host dev</span><br><span class="line">HostName 192.168.2.202</span><br><span class="line">Port 22</span><br><span class="line">User root</span><br><span class="line">IdentityFile ~/.ssh/202_id_rsa</span><br><span class="line"></span><br><span class="line"><span class="comment"># ssh 登录</span></span><br><span class="line">ssh dev</span><br></pre></td></tr></table></figure>

<blockquote>
<p>现在就可以使用秘钥+秘钥密码登录了，不设置秘钥密码会直接登录。</p>
</blockquote>
<h2 id="配置只能使用密钥文件登录"><a href="#配置只能使用密钥文件登录" class="headerlink" title="配置只能使用密钥文件登录"></a>配置只能使用密钥文件登录</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加或打开以下注释</span></span><br><span class="line">RSAAuthentication yes</span><br><span class="line">PubkeyAuthentication yes</span><br><span class="line">AuthorizedKeysFile      .ssh/authorized_keys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 禁用密码登录，必须使用ssh密钥文件登录</span></span><br><span class="line">PasswordAuthentication no</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存后重启 sshd 服务</span></span><br><span class="line">systemctl restart sshd.service</span><br></pre></td></tr></table></figure>

<h2 id="配置双重验证"><a href="#配置双重验证" class="headerlink" title="配置双重验证"></a>配置双重验证</h2><p>让服务器更安全，开启密码和证书双重验证：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开启密码登录</span></span><br><span class="line">PasswordAuthentication yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 双重认证</span></span><br><span class="line">AuthenticationMethods publickey,password</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存后重启 sshd 服务</span></span><br><span class="line">systemctl restart sshd.service</span><br></pre></td></tr></table></figure>

<h2 id="修改-ssh-端口"><a href="#修改-ssh-端口" class="headerlink" title="修改 ssh 端口"></a>修改 ssh 端口</h2><p><code>ssh</code> 默认端口为 <code>22</code> , 修改默认端口为 <code>1024 - 65535</code> 之间任意数字（注意不要和常用服务端口冲突），提高黑客破解难度。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br><span class="line"></span><br><span class="line"><span class="comment"># Port 22 修改为：其他端口</span></span><br><span class="line"></span><br><span class="line">Port 1234</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存后，配置防火墙开发端口</span></span><br><span class="line">firewall-cmd --zone=public --add-port=1234/tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启 sshd 服务</span></span><br><span class="line">systemctl restart sshd.service</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：需要配置防火墙。所有的操作，都要用新窗口登录测试，看看是否修改正确，</p>
</blockquote>
<h2 id="firewalld-配置"><a href="#firewalld-配置" class="headerlink" title="firewalld 配置"></a>firewalld 配置</h2><p><code>CentOS7</code> 的内核已经有防火墙 <code>netfilter</code>，较前版本的 <code>CentOS</code> 默认使用 <code>iptables</code>，但 <code>CentOS7</code> 开始使用配置跟简单、效能更高、稳定性更好的 <code>firewalld</code>（防火墙知识很多，有时间再开一篇写吧）若果服务器尚未安装 <code>firewalld</code>，可以使用以下指令安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">yum install firewalld</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动服务</span></span><br><span class="line">systemctl start firewalld</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置为开机启动</span></span><br><span class="line">systemctl <span class="built_in">enable</span> firewalld</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看防火墙开启了哪些服务和端口</span></span><br><span class="line">firewall-cmd --list-all</span><br></pre></td></tr></table></figure>

<p>配置 ssh 新端口允许防火墙通过：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 复制 firewalld 有关 sshd 的设定档案：</span></span><br><span class="line">cp /usr/lib/firewalld/services/ssh.xml /etc/firewalld/services/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编辑 ssh.xml</span></span><br><span class="line">vim /etc/firewalld/services/ssh.xml</span><br><span class="line"></span><br><span class="line"><span class="comment"># &lt;port protocol="tcp" port="22"/&gt; 修改为：你设置的sshd端口号</span></span><br><span class="line"></span><br><span class="line">&lt;port protocol=<span class="string">"tcp"</span> port=<span class="string">"1234"</span>/&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存 重新加载防火墙配置</span></span><br><span class="line"></span><br><span class="line">firewall-cmd --reload</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新开窗口验证登录</span></span><br><span class="line">ssh -p 1234 leo@SERVER_IP_ADDRESS</span><br></pre></td></tr></table></figure>

<blockquote>
<p>或者直接使命令开放 sshd 端口：firewall-cmd –zone=public –add-port=1234/tcp –permanent</p>
</blockquote>
<h2 id="每天自动更新软件"><a href="#每天自动更新软件" class="headerlink" title="每天自动更新软件"></a>每天自动更新软件</h2><p>（可选）</p>
<p>每一天都有成千上万的黑客在世界各地寻找 <code>Linux</code> 系统和常见软件的安全漏洞，保证软件是最新版本，可以及时修复最新漏洞，但最新的软件可能不稳定（程序员就是在制造 bug 和修复 bug 的路上……）。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 手动更新所有软件</span></span><br><span class="line">yum -y update</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装定时更新依赖</span></span><br><span class="line">yum -y install cronie yum-cron</span><br><span class="line"></span><br><span class="line"><span class="comment"># Anacron 每天执行这个档案一次，它根据配置档案 /etc/yum/yum-cron.conf 来更新软件</span></span><br><span class="line">/etc/cron.daily/0yum.cron</span><br><span class="line"><span class="comment"># 这是每天执行 yum-cron 的配置档案，默认只会下载更新的软件，并不安装，用意是让管理员检视 yum-cron 的输出，选取需要更新的软件进行手动安装。</span></span><br><span class="line">/etc/yum/yum-cron.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自动更新并安装配置 /etc/yum/yum-cron.conf 为：</span></span><br><span class="line">update_messages = yes, download_updates = yes, apply_updates = yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启定时更新服务</span></span><br><span class="line">systemctl start crond</span><br><span class="line">systemctl start yum-cron</span><br></pre></td></tr></table></figure>

<h2 id="系统安全加固"><a href="#系统安全加固" class="headerlink" title="系统安全加固"></a>系统安全加固</h2><ol>
<li><p>强制用户不重用最近使用的密码，降低密码猜测攻击风险</p>
<p>在 <code>/etc/pam.d/password-auth</code> 和 <code>/etc/pam.d/system-auth</code> 中 <code>password sufficient pam_unix.so</code> 这行的末尾配置 <code>remember</code> 参数为 <code>5-24</code> 之间，原来的内容不用更改, 只在末尾加了 <code>remember=5</code>。</p>
</li>
<li><p>检查密码长度和密码是否使用多种字符类型</p>
<p>编辑 <code>/etc/pam.d/password-auth</code> 和 <code>/etc/pam.d/system-auth</code> 配置文件中包含 <code>password requisite pam_cracklib.so</code> 这一行。增加配置 <code>minlen</code>（密码最小长度）设置为 9-32 位，<code>minclass</code>（至少包含小写字母、大写字母、数字、特殊字符等 4 类字符中等 3 类或 4 类）设置为 3 或 4。如 <code>password requisite pam_cracklib.so try_first_pass retry=3 minlen=11 minclass=3</code></p>
</li>
<li><p>确保 rsyslog 服务已启用，记录日志用于审计</p>
<p>运行以下命令启用 <code>rsyslog</code>：<code>service rsyslog start</code></p>
</li>
<li><p>确保 <code>ssh LogLevel</code> 设置为 <code>INFO</code>，记录登录和注销活动</p>
<p>编辑 <code>/etc/ssh/sshd_config</code> 文件以按如下方式设置参数(取消注释): <code>LogLevel INFO</code></p>
</li>
<li><p>设置较低的 <code>Max AuthTrimes</code> 参数将降低 SSH 服务器被暴力攻击成功的风险。</p>
<p>在 <code>/etc/ssh/sshd_config</code> 中取消 <code>MaxAuthTries</code> 注释符号 #，设置最大密码尝试失败次数 <code>3-6</code>，建议为 4：<code>MaxAuthTries 4</code></p>
</li>
<li><p>设置 SSH 空闲超时退出时间,可降低未授权用户访问其他用户 ssh 会话的风险</p>
<p>编辑 <code>/etc/ssh/sshd_config</code>，将 <code>ClientAliveInterval</code> 设置为 300 到 900，即 5-15 分钟，将 <code>ClientAliveCountMax</code> 设置为 0-3。<code>ClientAliveCountMax 2</code></p>
</li>
<li><p>设置密码失效时间，强制定期修改密码，减少密码被泄漏和猜测风险，使用非密码登陆方式(如密钥对)请忽略此项。</p>
<p>使用非密码登陆方式如密钥对，请忽略此项。在 <code>/etc/login.defs</code> 中将 <code>PASS_MAX_DAYS</code> 参数设置为 60-180 之间，如 <code>PASS_MAX_DAYS 90</code>。需同时执行命令设置 root 密码失效时间： <code>chage --maxdays 90 root</code>。</p>
</li>
<li><p>设置密码修改最小间隔时间，限制密码更改过于频繁</p>
<p>在 <code>/etc/login.defs</code> 中将 <code>PASS_MIN_DAYS</code> 参数设置为 7-14 之间,建议为 7： PASS_MIN_DAYS 7 需同时执行命令为 root 用户设置： <code>chage --mindays 7 root</code></p>
</li>
<li><p>SSHD 强制使用 V2 安全协议</p>
<p>编辑 <code>/etc/ssh/sshd_config</code> 文件以按如下方式设置参数：<code>Protocol 2</code></p>
</li>
<li><p>限制ssh访问服务器的源IP</p>
<p>编辑 <code>hosts.allow</code> 配置文件，追加一行内容 <code>echo &quot;sshd:192.168.43.226:allow&quot; &gt;&gt; /etc/hosts.allow</code>，编辑 <code>hosts.deny</code> 配置文件，追加一行内容 <code>echo &quot;sshd:ALL&quot; &gt;&gt; /etc/hosts.deny</code></p>
</li>
<li><p>限制ssh访问服务器的用户名</p>
<p>修改sshd_config配置文件，允许leo用户ssh访问服务器（以空格分开用户；添加完允许，默认拒绝其他所有用户）, <code>echo &quot;AllowUsers leo&quot; &gt;&gt; /etc/ssh/sshd_config</code>, 重启sshd服务 <code>systemctl restart sshd</code></p>
</li>
<li><p>修改telnet ssh端口时显示的版本号</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看sshd位置</span></span><br><span class="line">[root@centos1 ~]<span class="comment"># whereis sshd</span></span><br><span class="line">sshd: /usr/sbin/sshd /usr/share/man/man8/sshd.8.gz</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看SSH版本</span></span><br><span class="line">[root@imzcy ~]<span class="comment"># ssh -V</span></span><br><span class="line">OpenSSH_7.4p1, OpenSSL 1.0.2k-fips  26 Jan 2017</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看sshd程序关于版本的信息</span></span><br><span class="line">[root@imzcy ~]<span class="comment"># strings /usr/sbin/sshd |grep OpenSSH_7.4</span></span><br><span class="line">OpenSSH_7.4p1-RHEL7-7.4p1-11</span><br><span class="line">OpenSSH_7.4</span><br><span class="line">OpenSSH_7.4p1</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用sed替换版本（记得一定要先备份下）</span></span><br><span class="line">[root@imzcy ~]<span class="comment"># cp -p /usr/sbin/sshd ./</span></span><br><span class="line">[root@imzcy ~]<span class="comment"># sed -i 's/OpenSSH_7.4/OpenSSH_2.3/g' /usr/sbin/sshd</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#重启下sshd服务，没有报错即可</span></span><br><span class="line">[root@imzcy ~]<span class="comment"># systemctl restart sshd</span></span><br><span class="line"></span><br><span class="line">再使用telnet连接ssh端口，显示的版本则为：SSH-2.0-OpenSSH_2.3</span><br></pre></td></tr></table></figure>
</li>
</ol>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/linux/" rel="tag"># linux</a>
              <a href="/tags/centos7/" rel="tag"># centos7</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/back-end/linux/vmware-esxi-centos7/" rel="prev" title="在 VMware ESXi 中安装 CentOS7">
      <i class="fa fa-chevron-left"></i> 在 VMware ESXi 中安装 CentOS7
    </a></div>
      <div class="post-nav-item">
    <a href="/back-end/linux/linux-user-auth/" rel="next" title="Linux 用户管理和权限控制">
      Linux 用户管理和权限控制 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#配置网络"><span class="nav-number">1.</span> <span class="nav-text">配置网络</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#修改网卡配置文件"><span class="nav-number">1.1.</span> <span class="nav-text">修改网卡配置文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装常用工具"><span class="nav-number">2.</span> <span class="nav-text">安装常用工具</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建一个新用户"><span class="nav-number">3.</span> <span class="nav-text">创建一个新用户</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#给普通用户-root-权限"><span class="nav-number">4.</span> <span class="nav-text">给普通用户 root 权限</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#只允许-wheel-用户组的用户-su-切换"><span class="nav-number">5.</span> <span class="nav-text">只允许 wheel 用户组的用户 su 切换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tty-登录超时设置"><span class="nav-number">6.</span> <span class="nav-text">tty 登录超时设置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#限制登录失败次数并锁定"><span class="nav-number">7.</span> <span class="nav-text">限制登录失败次数并锁定</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#禁止-root-使用-ssh-登录"><span class="nav-number">8.</span> <span class="nav-text">禁止 root 使用 ssh 登录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#登录-IP-限制"><span class="nav-number">9.</span> <span class="nav-text">登录 IP 限制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#启用公钥授权验证登入-ssh"><span class="nav-number">10.</span> <span class="nav-text">启用公钥授权验证登入 ssh</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配置只能使用密钥文件登录"><span class="nav-number">11.</span> <span class="nav-text">配置只能使用密钥文件登录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配置双重验证"><span class="nav-number">12.</span> <span class="nav-text">配置双重验证</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修改-ssh-端口"><span class="nav-number">13.</span> <span class="nav-text">修改 ssh 端口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#firewalld-配置"><span class="nav-number">14.</span> <span class="nav-text">firewalld 配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#每天自动更新软件"><span class="nav-number">15.</span> <span class="nav-text">每天自动更新软件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#系统安全加固"><span class="nav-number">16.</span> <span class="nav-text">系统安全加固</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Richard"
      src="https://avatars3.githubusercontent.com/u/18113256?v=3&s=460">
  <p class="site-author-name" itemprop="name">Richard</p>
  <div class="site-description" itemprop="description">惶者生存，偏执者成功</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">132</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/xinlc" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xinlc" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/xinlc" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;xinlc" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://learnxinyminutes.com/" title="https:&#x2F;&#x2F;learnxinyminutes.com" rel="noopener" target="_blank">Learn X in Y minutes</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://justjavac.com/" title="http:&#x2F;&#x2F;justjavac.com" rel="noopener" target="_blank">justjavac</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.ruanyifeng.com/blog/" title="http:&#x2F;&#x2F;www.ruanyifeng.com&#x2F;blog&#x2F;" rel="noopener" target="_blank">阮一峰</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.liaoxuefeng.com/" title="https:&#x2F;&#x2F;www.liaoxuefeng.com" rel="noopener" target="_blank">廖雪峰</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://tech.meituan.com/" title="https:&#x2F;&#x2F;tech.meituan.com" rel="noopener" target="_blank">美团技术</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.v2ex.com/" title="https:&#x2F;&#x2F;www.v2ex.com" rel="noopener" target="_blank">V2EX</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://caniuse.com/" title="https:&#x2F;&#x2F;caniuse.com" rel="noopener" target="_blank">caniuse/工具</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.css88.com/nav/" title="http:&#x2F;&#x2F;www.css88.com&#x2F;nav&#x2F;" rel="noopener" target="_blank">css88/doc</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://overapi.com/" title="http:&#x2F;&#x2F;overapi.com&#x2F;" rel="noopener" target="_blank">OverAPI/api</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://devdocs.io/" title="http:&#x2F;&#x2F;devdocs.io&#x2F;" rel="noopener" target="_blank">DevDocs/api</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://tool.oschina.net/" title="http:&#x2F;&#x2F;tool.oschina.net&#x2F;" rel="noopener" target="_blank">在线工具/索引</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://tool.lu/" title="http:&#x2F;&#x2F;tool.lu&#x2F;" rel="noopener" target="_blank">ToolBox</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://hao.shejidaren.com/" title="http:&#x2F;&#x2F;hao.shejidaren.com&#x2F;" rel="noopener" target="_blank">设计导航</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Richard</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="//cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script>
<script src="/js/algolia-search.js"></script>














  

  

</body>
</html>
