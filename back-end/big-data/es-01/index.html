<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <link rel="mask-icon" href="/favicon.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.lichao.xin","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"appID":"3ZZ8ITB7HE","apiKey":"062eb5a54afbcbf3f20452d58fc40035","indexName":"xinlc","hits":{"per_page":10},"labels":{"input_placeholder":"搜索","hits_empty":"未发现与「${query}」相关的内容","hits_stats":"${hits} 条相关条目，使用了 ${time} 毫秒"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Elasticsearch 是一个基于 Lucene 的搜索引擎。基于 Lucene ，超越 Lucene。它提供了一个分布式多用户能力的全文搜索引擎，基于 RESTful web 接口。Elasticsearch 是用 Java 开发的，并作为 Apache 许可条款下的开放源码发布，是当前流行的企业级搜索引擎。设计用于云计算中，能够达到近实时搜索，稳定，可靠，快速。">
<meta property="og:type" content="article">
<meta property="og:title" content="重学 Elastic Stack 之 Elasticsearch 简介">
<meta property="og:url" content="https://blog.lichao.xin/back-end/big-data/es-01/index.html">
<meta property="og:site_name" content="Richard Xin&#39;s Blog">
<meta property="og:description" content="Elasticsearch 是一个基于 Lucene 的搜索引擎。基于 Lucene ，超越 Lucene。它提供了一个分布式多用户能力的全文搜索引擎，基于 RESTful web 接口。Elasticsearch 是用 Java 开发的，并作为 Apache 许可条款下的开放源码发布，是当前流行的企业级搜索引擎。设计用于云计算中，能够达到近实时搜索，稳定，可靠，快速。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/1.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/2.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/3.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/4.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/5.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/6.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/11.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/12.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/13.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/14.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/7.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/15.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/8.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/9.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/16.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/17.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/18.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/19.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/20.jpg">
<meta property="og:image" content="https://blog.lichao.xin/images/big-data/es-01/21.jpg">
<meta property="article:published_time" content="2021-01-30T09:25:00.000Z">
<meta property="article:modified_time" content="2021-06-14T01:33:22.379Z">
<meta property="article:author" content="Richard">
<meta property="article:tag" content="ES">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.lichao.xin/images/big-data/es-01/1.jpg">

<link rel="canonical" href="https://blog.lichao.xin/back-end/big-data/es-01/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>重学 Elastic Stack 之 Elasticsearch 简介 | Richard Xin's Blog</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?4530ac9d0bc4e258535c4a9b17029f0c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Richard Xin's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Richard Xin's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Quick notes</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">132</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">59</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">12</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

      
    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.lichao.xin/back-end/big-data/es-01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/18113256?v=3&s=460">
      <meta itemprop="name" content="Richard">
      <meta itemprop="description" content="惶者生存，偏执者成功">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Richard Xin's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          重学 Elastic Stack 之 Elasticsearch 简介
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-30 09:25:00" itemprop="dateCreated datePublished" datetime="2021-01-30T09:25:00+00:00">2021-01-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-14 01:33:22" itemprop="dateModified" datetime="2021-06-14T01:33:22+00:00">2021-06-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/BigData/" itemprop="url" rel="index"><span itemprop="name">BigData</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Elasticsearch 是一个基于 Lucene 的搜索引擎。基于 Lucene ，超越 Lucene。它提供了一个分布式多用户能力的全文搜索引擎，基于 RESTful web 接口。Elasticsearch 是用 Java 开发的，并作为 Apache 许可条款下的开放源码发布，是当前流行的企业级搜索引擎。设计用于云计算中，能够达到近实时搜索，稳定，可靠，快速。</p>
<a id="more"></a>

<h2 id="Elasticsearch-简介及其发展历史"><a href="#Elasticsearch-简介及其发展历史" class="headerlink" title="Elasticsearch 简介及其发展历史"></a>Elasticsearch 简介及其发展历史</h2><h3 id="从开源到上市"><a href="#从开源到上市" class="headerlink" title="从开源到上市"></a>从开源到上市</h3><ul>
<li>Elastic Inc - 开源软件 / 上市公司</li>
<li>当前市值超过 50 亿美金，开盘当天涨幅达 94%</li>
<li>Elasticsearch 软件下载量，超 3.5 亿次</li>
<li>10 万＋ 的社区成员</li>
<li>7200＋ 订阅用户，分布在 100＋ 国家</li>
<li>云服务 - Elastic，Amazon，阿里巴巴，腾讯</li>
</ul>
<p><img src="/images/big-data/es-01/1.jpg" alt="1"></p>
<p><a href="https://www.elastic.co/cn/blog/ze-bell-has-rung-thank-you-users-customers-and-partners" target="_blank" rel="noopener">2018年10月纽交所上市</a></p>
<p><img src="/images/big-data/es-01/2.jpg" alt="2"></p>
<p><a href="https://db-engines.com/en/ranking" target="_blank" rel="noopener">https://db-engines.com/en/ranking</a></p>
<h3 id="起源-Lucene"><a href="#起源-Lucene" class="headerlink" title="起源 - Lucene"></a>起源 - Lucene</h3><ul>
<li>基于 Java 语言开发的搜索引擎库类</li>
<li>创建于1999年，2005年成为 Apache顶级开源项目</li>
<li>Lucene 具有高性能、易扩展的优点</li>
<li>Lucene 的局限性∶<ul>
<li>只能基于 Java 语言开发</li>
<li>类库的接口学习曲线陡峭</li>
<li>原生并不支持水平扩展</li>
</ul>
</li>
</ul>
<p><img src="/images/big-data/es-01/3.jpg" alt="3"></p>
<h3 id="Elasticsearch-的诞生"><a href="#Elasticsearch-的诞生" class="headerlink" title="Elasticsearch 的诞生"></a>Elasticsearch 的诞生</h3><p>许多年前，一个刚结婚的名叫 Shay Banon 的失业开发者，跟着他的妻子去了伦敦，他的妻子在那里学习厨师。 在寻找一个赚钱的工作的时候，为了给他的妻子做一个食谱搜索引擎，他开始使用 Lucene 的一个早期版本。</p>
<p>直接使用 Lucene 是很难的，因此 Shay 开始做一个抽象层，Java 开发者使用它可以很简单的给他们的程序添加搜索功能。 他发布了他的第一个开源项目 Compass。</p>
<p>后来 Shay 获得了一份工作，主要是高性能，分布式环境下的内存数据网格。这个对于高性能，实时，分布式搜索引擎的需求尤为突出， 他决定重写 Compass，把它变为一个独立的服务并取名 Elasticsearch。</p>
<p>第一个公开版本在2010年2月发布，从此以后，Elasticsearch 已经成为了 Github 上最活跃的项目之一，他拥有超过300名 contributors(目前736名 contributors )。 一家公司已经开始围绕 Elasticsearch 提供商业服务，并开发新的特性，但是，Elasticsearch 将永远开源并对所有人可用。</p>
<p>据说，Shay 的妻子还在等着她的食谱搜索引擎…​</p>
<ul>
<li>2004年 Shay Banon 基于Lucene开发了Compass</li>
<li>2010年 Shay Banon重写了Compass，取名Elasticsearch<ul>
<li>支持分布式，可水平扩展</li>
<li>降低全文检索的学习曲线，可以被任何编程语言调用</li>
</ul>
</li>
</ul>
<p><img src="/images/big-data/es-01/4.jpg" alt="4"></p>
<blockquote>
<p>Search is something that any application should have.</p>
</blockquote>
<h3 id="Elasticsearch-的用途"><a href="#Elasticsearch-的用途" class="headerlink" title="Elasticsearch 的用途"></a>Elasticsearch 的用途</h3><p>Elasticsearch 在速度和可扩展性方面都表现出色，而且还能够索引多种类型的内容，这意味着其可用于多种用例：</p>
<ul>
<li>应用程序搜索</li>
<li>网站搜索</li>
<li>企业搜索</li>
<li>日志处理和分析</li>
<li>基础设施指标和容器监测</li>
<li>应用程序性能监测</li>
<li>地理空间数据分析和可视化</li>
<li>安全分析</li>
<li>业务分析  </li>
</ul>
<h3 id="Elasticsearch-的分布式架构"><a href="#Elasticsearch-的分布式架构" class="headerlink" title="Elasticsearch 的分布式架构"></a>Elasticsearch 的分布式架构</h3><ul>
<li>集群规模可以从单个扩展至数百个节点，处理PB级数据</li>
<li>高可用 &amp; 水平扩展<ul>
<li>服务和数据两个纬度</li>
</ul>
</li>
<li>支持不同的节点类型<ul>
<li>支持 Hot &amp; Warm 架构</li>
</ul>
</li>
</ul>
<p><img src="/images/big-data/es-01/5.jpg" alt="5"></p>
<h3 id="支持多种方式集成接入"><a href="#支持多种方式集成接入" class="headerlink" title="支持多种方式集成接入"></a>支持多种方式集成接入</h3><ul>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/client/index.html" target="_blank" rel="noopener">多种编程语言的类库</a><ul>
<li>Java /.NET / Python / Ruby / PHP/ Groowy / Perl</li>
</ul>
</li>
<li>RESTful API v.s Transport API<ul>
<li>9200 v.s 9300（建议使用RESTful API）</li>
</ul>
</li>
<li>JDBC &amp; ODBC</li>
</ul>
<h3 id="Elasticsearch-的主要功能"><a href="#Elasticsearch-的主要功能" class="headerlink" title="Elasticsearch 的主要功能"></a>Elasticsearch 的主要功能</h3><ul>
<li>海量数据的分户式存储以及集群管理<ul>
<li>服务与数据的高可用，水平扩展</li>
</ul>
</li>
<li>近实时搜索，性能卓越<ul>
<li>结构化/全文/地理位置/自动完成</li>
</ul>
</li>
<li>海量数据的近实时分析<ul>
<li>聚合功能</li>
</ul>
</li>
</ul>
<h3 id="Elastic-Stack-生态圈"><a href="#Elastic-Stack-生态圈" class="headerlink" title="Elastic Stack 生态圈"></a>Elastic Stack 生态圈</h3><p><img src="/images/big-data/es-01/6.jpg" alt="6"></p>
<h4 id="Logstash∶-数据处理管道"><a href="#Logstash∶-数据处理管道" class="headerlink" title="Logstash∶ 数据处理管道"></a>Logstash∶ 数据处理管道</h4><ul>
<li>开源的服务器端数据处理管道，支持从不同来源采集数据，转换数据，并将数据发送到不同的存储库中</li>
<li>Logstash 诞生于 2009年，最初用来做日志的采集与处理</li>
<li>Logstash 创始人 Jordan Sisel</li>
<li>2013 年被 Elasticsearch 收购</li>
</ul>
<p><img src="/images/big-data/es-01/11.jpg" alt="11"></p>
<blockquote>
<p>Remember: if a new user has a bad time, it’s a bug in logstash</p>
</blockquote>
<p><strong>Logstash 特性</strong></p>
<ul>
<li>实时解析和转换数据<ul>
<li>从 IP 地址破译出地理坐标</li>
<li>将 Pl 数据匿名化，完全排除敏感字段</li>
</ul>
</li>
<li>可扩展<ul>
<li>200 多个插件（日志/数据库/Arcsigh/Netflow）</li>
</ul>
</li>
<li>可靠性安全性。<ul>
<li>Logstash 会通过持久化队列来保证至少将运行中的事件送达一次</li>
<li>数据传输加密</li>
</ul>
</li>
<li>监控</li>
</ul>
<h4 id="Kibana∶-可视化分析利器"><a href="#Kibana∶-可视化分析利器" class="headerlink" title="Kibana∶ 可视化分析利器"></a>Kibana∶ 可视化分析利器</h4><ul>
<li>Kibana 名字的含义=Kiwifruit+Banana</li>
<li>数据可视化工具，帮助用户解开对数据的任何疑问</li>
<li>基于Logstash的工具，2013年加入Elastic公司</li>
</ul>
<p><img src="/images/big-data/es-01/12.jpg" alt="12"></p>
<h4 id="Elastic-的发展"><a href="#Elastic-的发展" class="headerlink" title="Elastic 的发展"></a>Elastic 的发展</h4><ul>
<li>2015 年 3 月收购 Elastic Cloud，提供 Cloud 服务</li>
<li>2015 年 3 月收购 PacketBeat</li>
<li>2016 年 9 月收购 PreAlert-Machine Learning 异常检测</li>
<li>2017 年 6 月收购 Opbeat 进军 APM</li>
<li>2017年11月收购 SaaS 厂商 Swiftype，提供网站和 App搜索</li>
<li>2018 年X-Pack 开源</li>
</ul>
<h4 id="BEATS-轻量的数据采集器"><a href="#BEATS-轻量的数据采集器" class="headerlink" title="BEATS - 轻量的数据采集器"></a>BEATS - 轻量的数据采集器</h4><p><img src="/images/big-data/es-01/13.jpg" alt="13"></p>
<ul>
<li>由 Go 语言开发</li>
<li>提供了很多轻量级抓包工具</li>
</ul>
<h4 id="X-Pack∶-商业化套件"><a href="#X-Pack∶-商业化套件" class="headerlink" title="X-Pack∶ 商业化套件"></a>X-Pack∶ 商业化套件</h4><ul>
<li>6.3 之前的版本，X-Pack 以插件方式安装</li>
<li>X-Pack 开源之后，Elasticsearch &amp; Kibana 支持 OSS 版和 Basic 两种版本<ul>
<li>部分 X-Pack 功能支持免费使用，6.8 和 7.1 开始，Security 功能免费</li>
</ul>
</li>
<li>OSS，Basic，黄金级，白金级</li>
<li><a href="https://www.elastic.co/cn/subscriptions" target="_blank" rel="noopener">https://www.elastic.co/cn/subscriptions</a></li>
</ul>
<p><img src="/images/big-data/es-01/14.jpg" alt="14"></p>
<h3 id="ELK-应用场景"><a href="#ELK-应用场景" class="headerlink" title="ELK 应用场景"></a>ELK 应用场景</h3><ul>
<li>网站搜索/垂直搜索/代码搜索</li>
<li>日志管理与分析/安全指标监控/应用性能监控/WEB抓取舆情分</li>
</ul>
<h4 id="日志的重要性"><a href="#日志的重要性" class="headerlink" title="日志的重要性"></a>日志的重要性</h4><ul>
<li>为什么重要<ul>
<li>运维∶ 医生给病人看病。日志就是病人对自己的陈述</li>
<li>恶意攻击，恶意注册，刷单，恶意密码猜测</li>
</ul>
</li>
<li>挑战<ul>
<li>关注点很多，任何一个点都有可能引起问题</li>
<li>日志分散在很多机器，出了问题时，才发现日志被删了</li>
<li>很多运维人员是消防员，哪里有问题去哪里</li>
</ul>
</li>
</ul>
<p><img src="/images/big-data/es-01/7.jpg" alt="7"></p>
<h4 id="日志管理"><a href="#日志管理" class="headerlink" title="日志管理"></a>日志管理</h4><p><img src="/images/big-data/es-01/15.jpg" alt="15"></p>
<h4 id="Elastichsearch与数据库的集成"><a href="#Elastichsearch与数据库的集成" class="headerlink" title="Elastichsearch与数据库的集成"></a>Elastichsearch与数据库的集成</h4><ul>
<li>单独使用 Elasticsearch 存储</li>
<li>以下情况可考虑与数据库集成<ul>
<li>与现有系统的集成</li>
<li>需考虑事务性</li>
<li>数据更新频繁</li>
</ul>
</li>
</ul>
<p><img src="/images/big-data/es-01/8.jpg" alt="8"></p>
<h4 id="指标分析-日志分析"><a href="#指标分析-日志分析" class="headerlink" title="指标分析/日志分析"></a>指标分析/日志分析</h4><p><img src="/images/big-data/es-01/9.jpg" alt="9"></p>
<h3 id="Elastic-产品生命周期结束-EOL-日期"><a href="#Elastic-产品生命周期结束-EOL-日期" class="headerlink" title="Elastic 产品生命周期结束 (EOL) 日期"></a>Elastic 产品生命周期结束 (EOL) 日期</h3><p><a href="https://www.elastic.co/cn/support/eol" target="_blank" rel="noopener">https://www.elastic.co/cn/support/eol</a></p>
<h4 id="新特性-5-x"><a href="#新特性-5-x" class="headerlink" title="新特性 5.x"></a>新特性 5.x</h4><ul>
<li>Lucene 6.x，性能提升，默认打分机制从 TF-IDF 改为 BM 25</li>
<li>支持Ingest节点/Painless Scripting /Completion suggested 支持/原生的Java REST客户端</li>
<li>Type 标记成 deprecated，支持了 Keyword 的类型</li>
<li>性能优化<ul>
<li>内部引擎移除了避免同一文档并发更新的竞争锁，带来 15% — 20% 的性能提升</li>
<li>Instant aggregation，支持分片上聚合的缓存</li>
<li>新增了 Profile API</li>
</ul>
</li>
</ul>
<h4 id="新特性-6-×"><a href="#新特性-6-×" class="headerlink" title="新特性 6.×"></a>新特性 6.×</h4><ul>
<li>Lucene 7.x</li>
<li>新功能<ul>
<li>跨集群复制（CCR）</li>
<li>索引生命周期管理</li>
<li>SQL 的支持</li>
</ul>
</li>
<li>更友好的的升级及数据迁移<ul>
<li>在主要版本之间的迁移更为简化，体验升级</li>
<li>全新的基于操作的数据复制框架，可加快恢复数据</li>
</ul>
</li>
<li>性能优化<ul>
<li>有效存储稀疏字段的新方法，降低了存储成本</li>
<li>在索引时进行排序，可加快排序的查询性能</li>
</ul>
</li>
</ul>
<h4 id="新特性-7-x"><a href="#新特性-7-x" class="headerlink" title="新特性 7.x"></a>新特性 7.x</h4><ul>
<li>Lucene 8.0</li>
<li>重大改进-正式废除单个索引下多 Type 的支持</li>
<li>7.1 开始，Security 功能免费使用</li>
<li>ECK-Elasticseach Operator on Kubernetes</li>
<li>新功能<ul>
<li>New Cluster coordination</li>
<li>Feature-Complete High Level REST Client o Script Score Query</li>
</ul>
</li>
<li>性能优化<ul>
<li>默认的 Primary Shard 数从5改为1，避免 Over Sharding</li>
<li>性能优化，更快的 Top K</li>
</ul>
</li>
</ul>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ul>
<li>Elasticsearch 是一个开源的分布式搜索与分析引擎，提供了近实时搜索和聚合两大功能。</li>
<li>Elastic Stack 围绕着 ELKB 构建出一套生态系统，适合大量的应用场景。</li>
<li>Elastic 公司通过并购，向用户提供 ML，APM，网站搜索等服务。</li>
<li>Elastic Stack 包括 Elasticsearch，Kibana，Logstash，Beats 等一系列产品。<ul>
<li>Elasticsearch 是核心引擎，提供了海量数据存储，搜索和聚合的能力。Beats 是轻量的数据采集器，Logstash用来做数据转换，Kibana 则提供了丰富的可视化展现与分析的功能。</li>
</ul>
</li>
<li>Elastic Stack 主要被广泛使用于∶搜索，日志管理，安全分析，指标分析，业务分析，应用性能监控等多个领域</li>
<li>Elastic Stack 开源了X-Pack在内的相关代码。作为商业解决方案，X-Pack的部分功能需要收费。Elastic 公司从6.8 和 7.1 开始，Security 功能也可以免费使用，（基础版免费）。</li>
<li>相比关系型数据库，Elasticsearch 提供了如模糊查询，搜索条件的算分第等关系型数据库所不擅长的功能，但是在事务性等方面，也不如关系型数据库来的强大。因此，在实际生产环境中，需要考虑具体业务要求，综合使用。</li>
</ul>
<h2 id="Elasticsearch-7-3-安装与简单配置"><a href="#Elasticsearch-7-3-安装与简单配置" class="headerlink" title="Elasticsearch 7.3 安装与简单配置"></a>Elasticsearch 7.3 安装与简单配置</h2><p>建议在 Docker 容器中运行 ES，Kibana 和 Cerebro，详情见 <a href="/back-end/docker/docker-elk">Elastic stack (ELK) on Docker</a></p>
<blockquote>
<p>基于 7.3 版本</p>
</blockquote>
<h3 id="安装-Java"><a href="#安装-Java" class="headerlink" title="安装 Java"></a>安装 Java</h3><ul>
<li>运行 Elastiosearch，需安装并配置 JDK<ul>
<li>设置 $JAVA_HOME</li>
</ul>
</li>
<li>各个版本对 Java 的依赖<ul>
<li>Elasticsearch 5 需要 Java 8 以上的版本</li>
<li>Elasticsearch 从6.5 开始支持 Java 11</li>
<li><a href="https://www.elastic.co/cn/support/matrix#matrix_jvm" target="_blank" rel="noopener">https://www.elastic.co/cn/support/matrix#matrix_jvm</a></li>
<li>7.0 开始，内置了 Java 环境</li>
</ul>
</li>
</ul>
<blockquote>
<p>二进制安装：<a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener">https://www.elastic.co/cn/downloads/elasticsearch</a></p>
</blockquote>
<h3 id="Elasticsearch-的文件目录结构"><a href="#Elasticsearch-的文件目录结构" class="headerlink" title="Elasticsearch 的文件目录结构"></a>Elasticsearch 的文件目录结构</h3><!-- ![10][10] -->

<table>
<thead>
<tr>
<th align="center">目录</th>
<th align="center">配置文件</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">bin</td>
<td align="center"></td>
<td align="center">脚本文件，包括启动 elasticsearch, 安装插件。运行统计数据等</td>
</tr>
<tr>
<td align="center">config</td>
<td align="center">elasticsearch.yml</td>
<td align="center">集群配置文件，user, role based 相关配置</td>
</tr>
<tr>
<td align="center">JDK</td>
<td align="center"></td>
<td align="center">Java 运行坏境</td>
</tr>
<tr>
<td align="center">data</td>
<td align="center">path.data</td>
<td align="center">数据文件</td>
</tr>
<tr>
<td align="center">lib</td>
<td align="center"></td>
<td align="center">Java 类库</td>
</tr>
<tr>
<td align="center">logs</td>
<td align="center">path.log</td>
<td align="center">日志文件</td>
</tr>
<tr>
<td align="center">modules</td>
<td align="center"></td>
<td align="center">包含所有ES模块</td>
</tr>
<tr>
<td align="center">plugins</td>
<td align="center"></td>
<td align="center">包含所有已安装插件</td>
</tr>
</tbody></table>
<h3 id="JVM-配置"><a href="#JVM-配置" class="headerlink" title="JVM 配置"></a>JVM 配置</h3><ul>
<li>修改 JVM - config/jvm.options<ul>
<li>7.1 下载的默认设置是 1 GB</li>
</ul>
</li>
<li>配置的建议<ul>
<li>Xmx 和 Xms 设置 成一样</li>
<li>Xmx 不要超过机器内存的 50%</li>
<li>不要超过 30GB - <a href="https://www.elastic.co/blog/a-heap-of-trouble" target="_blank" rel="noopener">https://www.elastic.co/blog/a-heap-of-trouble</a></li>
</ul>
</li>
</ul>
<h3 id="启动单节点"><a href="#启动单节点" class="headerlink" title="启动单节点"></a>启动单节点</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载并运行单个 Elasticsearch 实例</span></span><br><span class="line"><span class="comment"># 通过 -E 设定合适的参数</span></span><br><span class="line">bin/elasticsearch -E node.name=node0 -E cluster.name=demo-cluster -E path.data=node0_data</span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问：http://localhost:9200</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装插件 </span></span><br><span class="line"><span class="comment"># https://www.elastic.co/guide/en/elasticsearch/plugins/current/intro.html</span></span><br><span class="line">bin/elasticsearch-plugin install analysis-icu</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看插件</span></span><br><span class="line">bin/elasticsearch-plugin list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看安装的插件</span></span><br><span class="line">GET http://localhost:9200/_cat/plugins?v</span><br></pre></td></tr></table></figure>

<h3 id="单节点运行多个实例"><a href="#单节点运行多个实例" class="headerlink" title="单节点运行多个实例"></a>单节点运行多个实例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在单节点上运行集群</span></span><br><span class="line">bin/elasticsearch -E node.name=node0 -E cluster.name=demo-cluster -E path.data=node0_data</span><br><span class="line">bin/elasticsearch -E node.name=node1 -E cluster.name=demo-cluster -E path.data=node1_data</span><br><span class="line">bin/elasticsearch -E node.name=node2 -E cluster.name=demo-cluster -E path.data=node2_data</span><br><span class="line">bin/elasticsearch -E node.name=node3 -E cluster.name=demo-cluster -E path.data=node3_data</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看集群</span></span><br><span class="line">GET http://localhost:9200</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看nodes</span></span><br><span class="line">GET _cat/nodes</span><br><span class="line">GET _cluster/health</span><br></pre></td></tr></table></figure>

<h3 id="Kibana-安装"><a href="#Kibana-安装" class="headerlink" title="Kibana 安装"></a>Kibana 安装</h3><p><a href="https://www.elastic.co/cn/downloads/kibana" target="_blank" rel="noopener">https://www.elastic.co/cn/downloads/kibana</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动kibana</span></span><br><span class="line">bin/kibana</span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问：http://localhost:5601</span></span><br><span class="line"><span class="comment"># 常用 Dev Tool 控制台用于操控 ES</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看插件</span></span><br><span class="line"><span class="comment"># https://www.elastic.co/guide/en/kibana/current/known-plugins.html</span></span><br><span class="line">bin/kibana-plugin list</span><br></pre></td></tr></table></figure>

<h2 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h2><h3 id="搜索引擎开源项目"><a href="#搜索引擎开源项目" class="headerlink" title="搜索引擎开源项目"></a>搜索引擎开源项目</h3><ul>
<li><a href="https://lucene.apache.org/" target="_blank" rel="noopener">Lucene</a> 大名鼎鼎的搜索引擎类库，如果使用该技术实现，需要对 Lucene 的 API 和底层原理非常了解，而且需要编写大量的 Java 代码；</li>
<li><a href="http://lucene.apache.org/solr/" target="_blank" rel="noopener">Solr</a> 基于 Lucene 使用 Java 实现的一个 Web 应用，可以使用 REST 方式的 HTTP 请求，进行远程 API 的调用；</li>
<li><a href="https://www.elastic.co/cn/" target="_blank" rel="noopener">Elasticsearch</a> 基于 Lucene ，超越 Lucene，可以使用 REST 方式的 HTTP 请求，进行远程 API 的调用。</li>
</ul>
<h3 id="Solr-vs-Elasticsearch"><a href="#Solr-vs-Elasticsearch" class="headerlink" title="Solr vs Elasticsearch"></a>Solr vs Elasticsearch</h3><ul>
<li>Solr 利用 Zookeeper 进行分布式管理，而 Elasticsearch 自身带有分布式协调管理功能；</li>
<li>Solr 支持更多格式的数据，而 Elasticsearch 仅支持json文件格式；</li>
<li>Solr 官方提供的功能更多，而 Elasticsearch 本身更注重于核心功能，高级功能都由第三方插件提供；</li>
<li>Solr 在传统的搜索应用中表现好于 Elasticsearch，但在处理实时搜索应用时效率明显低于 Elasticsearch；</li>
<li>Solr 是传统搜索应用的有力解决方案，但 Elasticsearch 更适用于新兴的实时搜索应用。</li>
</ul>
<h3 id="Lucene"><a href="#Lucene" class="headerlink" title="Lucene"></a>Lucene</h3><h4 id="Lucene-简介"><a href="#Lucene-简介" class="headerlink" title="Lucene 简介"></a>Lucene 简介</h4><p>Lucene 是一种高性能、可伸缩的信息搜索（IR）库，在 2000 年开源，最初由鼎鼎大名的 Doug Cutting 开发，是基于 Java 实现的高性能的开源项目。</p>
<p>Lucene 采用了基于倒排表的设计原理，可以非常高效地实现文本查找，在底层采用了分段的存储模式，使它在读写时几乎完全避免了锁的出现，大大提升了读写性能。</p>
<h4 id="核心模块"><a href="#核心模块" class="headerlink" title="核心模块"></a>核心模块</h4><p>Lucene 的写流程和读流程如下图所示：</p>
<p><img src="/images/big-data/es-01/16.jpg" alt="16"></p>
<p>其中，虚线箭头（a、b、c、d）表示写索引的主要过程，实线箭头（1-9）表示查询的主要过程。</p>
<p>Lucene 中的主要模块及模块说明如下：</p>
<ul>
<li>analysis：主要负责词法分析及语言处理，也就是我们常说的分词，通过该模块可最终形成存储或者搜索的最小单元 Term。</li>
<li>index 模块：主要负责索引的创建工作。</li>
<li>store 模块：主要负责索引的读写，主要是对文件的一些操作，其主要目的是抽象出和平台文件系统无关的存储。</li>
<li>queryParser 模块：主要负责语法分析，把我们的查询语句生成 Lucene 底层可以识别的条件。</li>
<li>search 模块：主要负责对索引的搜索工作。</li>
<li>similarity 模块：主要负责相关性打分和排序的实现</li>
</ul>
<h4 id="核心术语"><a href="#核心术语" class="headerlink" title="核心术语"></a>核心术语</h4><p>下面介绍 Lucene 中的核心术语：</p>
<ul>
<li><p><strong>Term</strong>：是索引里最小的存储和查询单元，对于英文来说一般是指一个单词，对于中文来说一般是指一个分词后的词。</p>
</li>
<li><p><strong>词典（Term Dictionary，也叫作字典）</strong>：是 Term 的集合。词典的数据结构可以有很多种，每种都有自己的优缺点。</p>
<ul>
<li><p>比如：排序数组通过二分查找来检索数据：HashMap（哈希表）比排序数组的检索速度更快，但是会浪费存储空间。</p>
</li>
<li><p>FST (finite-state transducer) 有更高的数据压缩率和查询效率，因为词典是常驻内存的，而 FST 有很好的压缩率，所以 FST 在 Lucene 的最新版本中有非常多的使用场景，也是默认的词典数据结构。</p>
</li>
</ul>
</li>
<li><p><strong>倒排序（Posting List）</strong>：一篇文章通常由多个词组成，倒排表记录的是某个词在哪些文章中出现过。</p>
</li>
<li><p><strong>正向信息</strong>：原始的文档信息，可以用来做排序、聚合、展示等。</p>
</li>
<li><p><strong>段（Segment）</strong>：索引中最小的独立存储单元。一个索引文件由一个或者多个段组成。在 Luence 中的段有不变性，也就是说段一旦生成，在其上只能有读操作，不能有写操作。</p>
</li>
</ul>
<p>Lucene 的底层存储格式如下图所示，由词典和倒排序两部分组成，其中的词典就是 Term 的集合：</p>
<p><img src="/images/big-data/es-01/17.jpg" alt="17"></p>
<p>词典中的 Term 指向的文档链表的集合，叫做倒排表。词典和倒排表是 Lucene 中很重要的两种数据结构，是实现快速检索的重要基石。</p>
<p>词典和倒排表是分两部分存储的，在倒排序中不但存储了文档编号，还存储了词频等信息。</p>
<p>在上图所示的词典部分包含三个词条（Term）：Elasticsearch、Lucene 和 Solr。词典数据是查询的入口，所以这部分数据是以 FST 的形式存储在内存中的。</p>
<p>在倒排表中，“Lucene” 指向有序链表 3，7，15，30，35，67，表示字符串 “Lucene” 在文档编号为 3、7、15、30、35、67 的文章中出现过，Elasticsearch 和 Solr 同理。</p>
<h4 id="检索方式"><a href="#检索方式" class="headerlink" title="检索方式"></a>检索方式</h4><p>在 Lucene 的查询过程中的主要检索方式有以下四种：</p>
<p><strong>单个词查询</strong></p>
<p>指对一个 Term 进行查询。比如，若要查找包含字符串 “Lucene” 的文档，则只需在词典中找到 Term “Lucene”，再获得在倒排表中对应的文档链表即可。</p>
<p><strong>AND</strong></p>
<p>指对多个集合求交集。比如，若要查找既包含字符串 “Lucene” 又包含字符串 “Solr” 的文档，则查找步骤如下：</p>
<ul>
<li>在词典中找到 Term “Lucene”，得到 “Lucene” 对应的文档链表。</li>
<li>在词典中找到 Term “Solr”，得到 “Solr” 对应的文档链表。</li>
<li>合并链表，对两个文档链表做交集运算，合并后的结果既包含 “Lucene” 也包含 “Solr”。</li>
</ul>
<p><strong>OR</strong></p>
<p>指多个集合求并集。比如，若要查找包含字符串 “Luence” 或者包含字符串 “Solr” 的文档，则查找步骤如下：</p>
<ul>
<li>在词典中找到 Term “Lucene”，得到 “Lucene” 对应的文档链表。</li>
<li>在词典中找到 Term “Solr”，得到 “Solr” 对应的文档链表。</li>
<li>合并链表，对两个文档链表做并集运算，合并后的结果包含 “Lucene” 或者包含 “Solr”。</li>
</ul>
<p><strong>NOT</strong></p>
<p>指对多个集合求差集。比如，若要查找包含字符串 “Solr” 但不包含字符串 “Lucene” 的文档，则查找步骤如下：</p>
<ul>
<li>在词典中找到 Term “Lucene”，得到 “Lucene” 对应的文档链表。</li>
<li>在词典中找到 Term “Solr”，得到 “Solr” 对应的文档链表。</li>
<li>合并链表，对两个文档链表做差集运算，用包含 “Solr” 的文档集减去包含 “Lucene” 的文档集，运算后的结果就是包含 “Solr” 但不包含 “Lucene”。</li>
</ul>
<p>通过上述四种查询方式，我们不难发现，由于 Lucene 是以倒排表的形式存储的。</p>
<p>所以在 Lucene 的查找过程中只需在词典中找到这些 Term，根据 Term 获得文档链表，然后根据具体的查询条件对链表进行交、并、差等操作，就可以准确地查到我们想要的结果。</p>
<p>相对于在关系型数据库中的 “Like” 查找要做全表扫描来说，这种思路是非常高效的。</p>
<p>虽然在索引创建时要做很多工作，但这种一次生成、多次使用的思路也是非常高明的。</p>
<h4 id="分段存储"><a href="#分段存储" class="headerlink" title="分段存储"></a>分段存储</h4><p>在早期的全文检索中为整个文档集合建立了一个很大的倒排索引，并将其写入磁盘中，如果索引有更新，就需要重新全量创建一个索引来替换原来的索引。</p>
<p>这种方式在数据量很大时效率很低，并且由于创建一次索引的成本很高，所以对数据的更新不能过于频繁，也就不能保证实效性。</p>
<p>现在，在搜索中引入了段的概念（将一个索引文件拆分为多个子文件，则每个子文件叫做段），每个段都是一个独立的可被搜索的数据集，并且段具有不变性，一旦索引的数据被写入硬盘，就不可修改。</p>
<p>在分段的思想下，对数据写操作的过程如下：</p>
<ul>
<li>新增：当有新的数据需要创建索引时，由于段段不变性，所以选择新建一个段来存储新增的数据。</li>
<li>删除：当需要删除数据时，由于数据所在的段只可读，不可写，所以 Lucene 在索引文件新增一个 .del 的文件，用来专门存储被删除的数据 id。</li>
<li>当查询时，被删除的数据还是可以被查到的，只是在进行文档链表合并时，才把已经删除的数据过滤掉。被删除的数据在进行段合并时才会被真正被移除。</li>
<li>更新：更新的操作其实就是删除和新增的组合，先在.del 文件中记录旧数据，再在新段中添加一条更新后的数据。</li>
</ul>
<p>段不可变性的优点如下：</p>
<ul>
<li>不需要锁：因为数据不会更新，所以不用考虑多线程下的读写不一致情况。</li>
<li>可以常驻内存：段在被加载到内存后，由于具有不变性，所以只要内存的空间足够大，就可以长时间驻存，大部分查询请求会直接访问内存，而不需要访问磁盘，使得查询的性能有很大的提升。</li>
<li>缓存友好：在段的声明周期内始终有效，不需要在每次数据更新时被重建。</li>
<li>增量创建：分段可以做到增量创建索引，可以轻量级地对数据进行更新，由于每次创建的成本很低，所以可以频繁地更新数据，使系统接近实时更新。</li>
</ul>
<p>段不可变性的缺点如下：</p>
<ul>
<li>删除：当对数据进行删除时，旧数据不会被马上删除，而是在 .del 文件中被标记为删除。而旧数据只能等到段更新时才能真正地被移除，这样会有大量的空间浪费。</li>
<li>更新：更新数据由删除和新增这两个动作组成。若有一条数据频繁更新，则会有大量的空间浪费。</li>
<li>新增：由于索引具有不变性，所以每次新增数据时，都需要新增一个段来存储数据。当段段数量太多时，对服务器的资源（如文件句柄）的消耗会非常大，查询的性能也会受到影响。</li>
<li>过滤：在查询后需要对已经删除的旧数据进行过滤，这增加了查询的负担。</li>
</ul>
<p>为了提升写的性能，Lucene 并没有每新增一条数据就增加一个段，而是采用延迟写的策略，每当有新增的数据时，就将其先写入内存中，然后批量写入磁盘中。</p>
<p>若有一个段被写到硬盘，就会生成一个提交点，提交点就是一个用来记录所有提交后的段信息的文件。</p>
<p>一个段一旦拥有了提交点，就说明这个段只有读的权限，失去了写的权限；相反，当段在内存中时，就只有写数据的权限，而不具备读数据的权限，所以也就不能被检索了。</p>
<p>从严格意义上来说，Lucene 或者 Elasticsearch 并不能被称为实时的搜索引擎，只能被称为准实时的搜索引擎。</p>
<p>写索引的流程如下：</p>
<ul>
<li>新数据被写入时，并没有被直接写到硬盘中，而是被暂时写到内存中。Lucene 默认是一秒钟，或者当内存中数据量达到一定阶段时，再批量提交到磁盘中。</li>
<li>当然，默认的时间和数据量的大小是可以通过参数控制的。通过延时写的策略，可以减少数据往磁盘上写的次数，从而提升整体的写入性能，如图 3。</li>
<li>在达到出触发条件以后，会将内存中缓存的数据一次性写入磁盘中，并生成提交点。</li>
<li>清空内存，等待新的数据写入，如下图所示。</li>
</ul>
<p><img src="/images/big-data/es-01/18.jpg" alt="18"></p>
<p>从上述流程可以看出，数据先被暂时缓存在内存中，在达到一定的条件再被一次性写入硬盘中，这种做法可以大大提升数据写入的速度。</p>
<p>但是数据先被暂时存放在内存中，并没有真正持久化到磁盘中，所以如果这时出现断电等不可控的情况，就会丢失数据，为此，Elasticsearch 添加了事务日志，来保证数据的安全。</p>
<h4 id="段合并策略"><a href="#段合并策略" class="headerlink" title="段合并策略"></a>段合并策略</h4><p>虽然分段比每次都全量创建索引有更高的效率，但是由于在每次新增数据时都会新增一个段，所以经过长时间的的积累，会导致在索引中存在大量的段。</p>
<p>当索引中段的数量太多时，不仅会严重消耗服务器的资源，还会影响检索的性能。</p>
<p>因为索引检索的过程是：查询所有段中满足查询条件的数据，然后对每个段里查询的结果集进行合并，所以为了控制索引里段的数量，我们必须定期进行段合并操作。</p>
<p>但是如果每次合并全部的段，则会造成很大的资源浪费，特别是 “大段” 的合并。</p>
<p>所以 Lucene 现在的段合并思路是：根据段的大小将段进行分组，再将属于同一组的段进行合并。</p>
<p>但是由于对于超级大的段的合并需要消耗更多的资源，所以 Lucene 会在段的大小达到一定规模，或者段里面的数据量达到一定条数时，不会再进行合并。</p>
<p>所以 Lucene 的段合并主要集中在对中小段的合并上，这样既可以避免对大段进行合并时消耗过多的服务器资源，也可以很好地控制索引中段的数量。</p>
<p>段合并的主要参数如下：</p>
<ul>
<li>mergeFactor：每次合并时参与合并的最少数量，当同一组的段的数量达到此值时开始合并，如果小于此值则不合并，这样做可以减少段合并的频率，其默认值为 10。</li>
<li>SegmentSize：指段的实际大小，单位为字节。</li>
<li>minMergeSize：小于这个值的段会被分到一组，这样可以加速小片段的合并。</li>
<li>maxMergeSize：若有一段的文本数量大于此值，就不再参与合并，因为大段合并会消耗更多的资源。</li>
</ul>
<p>段合并相关的动作主要有以下两个：</p>
<ul>
<li>对索引中的段进行分组，把大小相近的段分到一组，主要由 LogMergePolicy1 类来处理。</li>
<li>将属于同一分组的段合并成一个更大的段。</li>
</ul>
<p>在段合并前对段的大小进行了标准化处理，通过 logMergeFactorSegmentSize 计算得出。</p>
<p>其中 MergeFactor 表示一次合并的段的数量，Lucene 默认该数量为 10；SegmentSize 表示段的实际大小。通过上面的公式计算后，段的大小更加紧凑，对后续的分组更加友好。</p>
<p>段分组的步骤如下</p>
<ol>
<li>根据段生成的时间对段进行排序，然后根据上述标准化公式计算每个段的大小并且存放到段信息中，后面用到的描述段大小的值都是标准化后的值，如图所示：</li>
</ol>
<p><img src="/images/big-data/es-01/19.jpg" alt="19"></p>
<ol start="2">
<li><p>在数组中找到最大的段，然后生成一个由最大段的标准化值作为上限，减去 LEVEL_LOG_SPAN（默认值为 0.75）后的值作为下限的区间，小于等于上限并且大于下限的段，都被认为是属于同一组的段，可以合并。</p>
</li>
<li><p>在确定一个分组的上下限值后，就需要查找属于这个分组的段了，具体过程是：创建两个指针（在这里使用指针的概念是为了更好地理解）start 和 end。</p>
</li>
</ol>
<p>start 指向数组的第 1 个段，end 指向第 start+MergeFactor 个段，然后从 end 逐个向前查找落在区间的段。</p>
<p>当找到第 1 个满足条件的段时，则停止，并把当前段到 start 之间的段统一分到一个组，无论段的大小是否满足当前分组的条件。</p>
<p>如图所示，第 2 个段明显小于该分组的下限，但还是被分到了这一组。</p>
<p><img src="/images/big-data/es-01/20.jpg" alt="20"></p>
<p>这样做的好处如下：</p>
<ul>
<li>增加段合并的概率，避免由于段的大小参差不齐导致段难以合并。</li>
<li>简化了查找的逻辑，使代码的运行效率更高。</li>
</ul>
<ol start="4">
<li>在分组找到后，需要排除不参加合并的 “超大” 段，然后判断剩余的段是否满足合并的条件。</li>
</ol>
<p>如上图所示，mergeFactor=5，而找到的满足合并条件的段的个数为 4，所以不满足合并的条件，暂时不进行合并，继续找寻下一个组的上下限。</p>
<ol start="5">
<li>由于在第 4 步并没有找到满足段合并的段的数量，所以这一分组的段不满足合并的条件，继续进行下一分组段的查找。</li>
</ol>
<p>具体过程是：将 start 指向 end，在剩下的段（从 end 指向的元素开始到数组的最后一个元素）中寻找最大的段，在找到最大的值后再减去 LEVEL_LOG_SPAN 的值，再生成一下分组的区间值。</p>
<p>然后把 end 指向数组的第 start+MergeFactor 个段，逐个向前查找第 1 个满足条件的段：重复第 3 步和第 4 步。</p>
<ol start="6">
<li>如果一直没有找到满足合并条件的段，则一直重复第 5 步，直到遍历完整个数组，如图所示：</li>
</ol>
<p><img src="/images/big-data/es-01/21.jpg" alt="21"></p>
<ol start="7">
<li>在找到满足条件的 mergeFactor 个段时，就需要开始合并了。但是在满足合并条件的段大于 mergeFactor 时，就需要进行多次合并。</li>
</ol>
<p>也就是说每次依然选择 mergeFactor 个段进行合并，直到该分组的所有段合并完成，再进行下一分组的查找合并操作。</p>
<ol start="8">
<li>通过上述几步，如果找到了满足合并要求的段，则将会进行段的合并操作。</li>
</ol>
<p>因为索引里面包含了正向信息和反向信息，所以段合并的操作分为两部分：</p>
<ul>
<li>一个是正向信息合并，例如存储域、词向量、标准化因子等。</li>
<li>一个是反向信息的合并，例如词典、倒排表等。</li>
</ul>
<p>在段合并时，除了需要对索引数据进行合并，还需要移除段中已经删除的数据。</p>
<h4 id="Lucene-相似度打分"><a href="#Lucene-相似度打分" class="headerlink" title="Lucene 相似度打分"></a>Lucene 相似度打分</h4><p>我们在前面了解到，Lucene 的查询过程是：首先在词典中查找每个 Term，根据 Term 获得每个 Term 所在的文档链表；然后根据查询条件对链表做交、并、差等操作，链表合并后的结果集就是我们要查找的数据。</p>
<p>这样做可以完全避免对关系型数据库进行全表扫描，可以大大提升查询效率。</p>
<p>但是，当我们一次查询出很多数据时，这些数据和我们的查询条件又有多大关系呢？其文本相似度是多少？</p>
<p>后面会回答这个问题，并介绍 Lucene 最经典的两个文本相似度算法：基于向量空间模型的算法和基于概率的算法（BM25）。</p>
<p>如果对此算法不太感兴趣，那么只需了解对文本相似度有影响的因子有哪些，哪些是正向的，哪些是逆向的即可，不需要理解每个算法的推理过程。但是这两个文本相似度算法有很好的借鉴意义。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/intro.html" target="_blank" rel="noopener">https://www.elastic.co/guide/cn/elasticsearch/guide/current/intro.html</a></li>
<li><a href="https://www.elastic.co/cn/what-is/elasticsearch" target="_blank" rel="noopener">https://www.elastic.co/cn/what-is/elasticsearch</a></li>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-replication.html" target="_blank" rel="noopener">https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-replication.html</a></li>
<li><a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener">https://www.elastic.co/cn/downloads/elasticsearch</a></li>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html" target="_blank" rel="noopener">https://www.elastic.co/guide/en/elasticsearch/reference/current/settings.html</a></li>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/important-settings.html" target="_blank" rel="noopener">https://www.elastic.co/guide/en/elasticsearch/reference/current/important-settings.html</a></li>
<li>《Elasticsearch核心技术与实战》</li>
<li><a href="https://elasticsearch.cn" target="_blank" rel="noopener">https://elasticsearch.cn</a></li>
<li><a href="https://www.elastic.co/cn/blog" target="_blank" rel="noopener">https://www.elastic.co/cn/blog</a></li>
<li><a href="https://lucene.apache.org" target="_blank" rel="noopener">https://lucene.apache.org</a></li>
<li><a href="https://lucene.apache.org/solr" target="_blank" rel="noopener">https://lucene.apache.org/solr</a></li>
</ul>
<style>
  img {
    zoom: 50%;
  }
</style>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/ES/" rel="tag"># ES</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/back-end/linux/wsl-ubuntu/" rel="prev" title="Windows10 安装 Ubuntu 子系统">
      <i class="fa fa-chevron-left"></i> Windows10 安装 Ubuntu 子系统
    </a></div>
      <div class="post-nav-item">
    <a href="/back-end/big-data/es-02/" rel="next" title="重学 Elastic Stack 之 Elasticsearch 核心概念">
      重学 Elastic Stack 之 Elasticsearch 核心概念 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Elasticsearch-简介及其发展历史"><span class="nav-number">1.</span> <span class="nav-text">Elasticsearch 简介及其发展历史</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#从开源到上市"><span class="nav-number">1.1.</span> <span class="nav-text">从开源到上市</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#起源-Lucene"><span class="nav-number">1.2.</span> <span class="nav-text">起源 - Lucene</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Elasticsearch-的诞生"><span class="nav-number">1.3.</span> <span class="nav-text">Elasticsearch 的诞生</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Elasticsearch-的用途"><span class="nav-number">1.4.</span> <span class="nav-text">Elasticsearch 的用途</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Elasticsearch-的分布式架构"><span class="nav-number">1.5.</span> <span class="nav-text">Elasticsearch 的分布式架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#支持多种方式集成接入"><span class="nav-number">1.6.</span> <span class="nav-text">支持多种方式集成接入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Elasticsearch-的主要功能"><span class="nav-number">1.7.</span> <span class="nav-text">Elasticsearch 的主要功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Elastic-Stack-生态圈"><span class="nav-number">1.8.</span> <span class="nav-text">Elastic Stack 生态圈</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Logstash∶-数据处理管道"><span class="nav-number">1.8.1.</span> <span class="nav-text">Logstash∶ 数据处理管道</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Kibana∶-可视化分析利器"><span class="nav-number">1.8.2.</span> <span class="nav-text">Kibana∶ 可视化分析利器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Elastic-的发展"><span class="nav-number">1.8.3.</span> <span class="nav-text">Elastic 的发展</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BEATS-轻量的数据采集器"><span class="nav-number">1.8.4.</span> <span class="nav-text">BEATS - 轻量的数据采集器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#X-Pack∶-商业化套件"><span class="nav-number">1.8.5.</span> <span class="nav-text">X-Pack∶ 商业化套件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ELK-应用场景"><span class="nav-number">1.9.</span> <span class="nav-text">ELK 应用场景</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#日志的重要性"><span class="nav-number">1.9.1.</span> <span class="nav-text">日志的重要性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#日志管理"><span class="nav-number">1.9.2.</span> <span class="nav-text">日志管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Elastichsearch与数据库的集成"><span class="nav-number">1.9.3.</span> <span class="nav-text">Elastichsearch与数据库的集成</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#指标分析-日志分析"><span class="nav-number">1.9.4.</span> <span class="nav-text">指标分析&#x2F;日志分析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Elastic-产品生命周期结束-EOL-日期"><span class="nav-number">1.10.</span> <span class="nav-text">Elastic 产品生命周期结束 (EOL) 日期</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#新特性-5-x"><span class="nav-number">1.10.1.</span> <span class="nav-text">新特性 5.x</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#新特性-6-×"><span class="nav-number">1.10.2.</span> <span class="nav-text">新特性 6.×</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#新特性-7-x"><span class="nav-number">1.10.3.</span> <span class="nav-text">新特性 7.x</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小结"><span class="nav-number">1.11.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Elasticsearch-7-3-安装与简单配置"><span class="nav-number">2.</span> <span class="nav-text">Elasticsearch 7.3 安装与简单配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装-Java"><span class="nav-number">2.1.</span> <span class="nav-text">安装 Java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Elasticsearch-的文件目录结构"><span class="nav-number">2.2.</span> <span class="nav-text">Elasticsearch 的文件目录结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JVM-配置"><span class="nav-number">2.3.</span> <span class="nav-text">JVM 配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#启动单节点"><span class="nav-number">2.4.</span> <span class="nav-text">启动单节点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#单节点运行多个实例"><span class="nav-number">2.5.</span> <span class="nav-text">单节点运行多个实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Kibana-安装"><span class="nav-number">2.6.</span> <span class="nav-text">Kibana 安装</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#扩展"><span class="nav-number">3.</span> <span class="nav-text">扩展</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#搜索引擎开源项目"><span class="nav-number">3.1.</span> <span class="nav-text">搜索引擎开源项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solr-vs-Elasticsearch"><span class="nav-number">3.2.</span> <span class="nav-text">Solr vs Elasticsearch</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Lucene"><span class="nav-number">3.3.</span> <span class="nav-text">Lucene</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Lucene-简介"><span class="nav-number">3.3.1.</span> <span class="nav-text">Lucene 简介</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#核心模块"><span class="nav-number">3.3.2.</span> <span class="nav-text">核心模块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#核心术语"><span class="nav-number">3.3.3.</span> <span class="nav-text">核心术语</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#检索方式"><span class="nav-number">3.3.4.</span> <span class="nav-text">检索方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#分段存储"><span class="nav-number">3.3.5.</span> <span class="nav-text">分段存储</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#段合并策略"><span class="nav-number">3.3.6.</span> <span class="nav-text">段合并策略</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Lucene-相似度打分"><span class="nav-number">3.3.7.</span> <span class="nav-text">Lucene 相似度打分</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考"><span class="nav-number">4.</span> <span class="nav-text">参考</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Richard"
      src="https://avatars3.githubusercontent.com/u/18113256?v=3&s=460">
  <p class="site-author-name" itemprop="name">Richard</p>
  <div class="site-description" itemprop="description">惶者生存，偏执者成功</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">132</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/xinlc" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xinlc" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/xinlc" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;xinlc" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://learnxinyminutes.com/" title="https:&#x2F;&#x2F;learnxinyminutes.com" rel="noopener" target="_blank">Learn X in Y minutes</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://justjavac.com/" title="http:&#x2F;&#x2F;justjavac.com" rel="noopener" target="_blank">justjavac</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.ruanyifeng.com/blog/" title="http:&#x2F;&#x2F;www.ruanyifeng.com&#x2F;blog&#x2F;" rel="noopener" target="_blank">阮一峰</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.liaoxuefeng.com/" title="https:&#x2F;&#x2F;www.liaoxuefeng.com" rel="noopener" target="_blank">廖雪峰</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://tech.meituan.com/" title="https:&#x2F;&#x2F;tech.meituan.com" rel="noopener" target="_blank">美团技术</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.v2ex.com/" title="https:&#x2F;&#x2F;www.v2ex.com" rel="noopener" target="_blank">V2EX</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://caniuse.com/" title="https:&#x2F;&#x2F;caniuse.com" rel="noopener" target="_blank">caniuse/工具</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.css88.com/nav/" title="http:&#x2F;&#x2F;www.css88.com&#x2F;nav&#x2F;" rel="noopener" target="_blank">css88/doc</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://overapi.com/" title="http:&#x2F;&#x2F;overapi.com&#x2F;" rel="noopener" target="_blank">OverAPI/api</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://devdocs.io/" title="http:&#x2F;&#x2F;devdocs.io&#x2F;" rel="noopener" target="_blank">DevDocs/api</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://tool.oschina.net/" title="http:&#x2F;&#x2F;tool.oschina.net&#x2F;" rel="noopener" target="_blank">在线工具/索引</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://tool.lu/" title="http:&#x2F;&#x2F;tool.lu&#x2F;" rel="noopener" target="_blank">ToolBox</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://hao.shejidaren.com/" title="http:&#x2F;&#x2F;hao.shejidaren.com&#x2F;" rel="noopener" target="_blank">设计导航</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Richard</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="//cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script>
<script src="/js/algolia-search.js"></script>














  

  

</body>
</html>
